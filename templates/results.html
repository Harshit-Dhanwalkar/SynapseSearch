<!doctype html>
<html lang="en" data-theme="dark">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Results for "{{ query }}" - SynapseSearch</title>
    <link
      href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css"
    />
    <link
      rel="stylesheet"
      href="{{ url_for('static', filename='css/theme-switcher.css') }}"
    />
    <script
      src="{{ url_for('static', filename='js/theme-switcher.js') }}"
      defer
    ></script>
  </head>
  <body
    class="min-h-screen flex flex-col items-center theme-bg-main theme-text-primary"
  >
    <header
      class="w-full flex items-center justify-between p-4 theme-bg-header theme-text-primary shadow-lg"
    >
      <a href="/" class="flex-shrink-0 text-2xl font-bold">SynapseSearch</a>
      <div class="flex-grow max-w-xl mx-4">
        <form action="/search" method="get" class="relative">
          <input
            type="text"
            name="query"
            value="{{ query }}"
            class="w-full px-4 py-2 border rounded-full theme-input theme-border"
            placeholder="Search again..."
          />
          <input
            type="hidden"
            name="mode"
            value="{{ request.args.get('mode', 'keyword') }}"
          />
          <button
            type="submit"
            class="absolute right-0 top-0 mt-2 mr-4 theme-text-secondary"
          >
            <i class="fas fa-search"></i>
          </button>
        </form>
      </div>
      {% include 'partials/theme-switcher.html' %}
    </header>

    <main class="w-full max-w-4xl p-6 flex-grow theme-bg-main">
      <div class="flex border-b theme-border mb-6">
        <button
          onclick="changeContentType('all')"
          class="py-2 px-4 {% if content_type == 'all' %}tab-active{% else %}theme-text-secondary{% endif %}"
        >
          All
        </button>
        <button
          onclick="changeContentType('images')"
          class="py-2 px-4 {% if content_type == 'images' %}tab-active{% else %}theme-text-secondary{% endif %}"
        >
          Images
        </button>
      </div>

      <div class="text-xl font-semibold mb-4 theme-text-primary">
        {{ message }}
      </div>

      {% if content_type == 'all' %}
      <div class="space-y-6">
        {% for result in results %}
        <div
          class="p-4 rounded-lg shadow-md hover:theme-bg-card transition-colors theme-bg-card"
        >
          <a
            href="{{ result.url }}"
            class="block text-xl font-semibold theme-link hover:underline"
            >{{ result.title }}</a
          >
          <div class="text-sm theme-link">{{ result.url|url_domain }}</div>

          <p class="theme-text-secondary mt-2">
            {{ result.snippet }}...
            <span class="theme-text-secondary">Score: {{ result.score }}</span>
          </p>

          {% if result.images %}
          <div class="flex mt-4 gap-2">
            {% for image in result.images[:3] %}
            <img
              src="{{ image.src }}"
              alt="{{ image.alt }}"
              class="h-16 w-16 object-cover rounded"
            />
            {% endfor %}
          </div>
          {% endif %}
        </div>
        {% endfor %}
      </div>
      {% elif content_type == 'images' %}
      <div class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-4">
        {% for result in results %} {% for image in result.images %}
        <div class="relative group">
          <a href="{{ result.url }}">
            <img
              src="{{ image.src }}"
              alt="{{ image.alt }}"
              class="w-full h-48 object-cover rounded-lg group-hover:opacity-75"
            />
            <div
              class="absolute bottom-0 left-0 right-0 p-2 bg-black bg-opacity-50 text-white text-xs rounded-b-lg hidden group-hover:block"
            >
              {{ image.alt }}
            </div>
          </a>
        </div>
        {% endfor %} {% endfor %}
      </div>
      {% endif %}
    </main>
  </body>
</html>
